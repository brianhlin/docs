<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Submitting to HTCondor-CE - OSG Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Submitting to HTCondor-CE";
    var mkdocs_page_input_path = "compute-element/submit-htcondor-ce.md";
    var mkdocs_page_url = "/compute-element/submit-htcondor-ce/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OSG Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
  
    <a class="" href="../..">Home</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  
    <a class="" href="../../site-planning/">Site Planning</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Compute Element</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../htcondor-ce-overview/">HTCondor-CE Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../install-htcondor-ce/">Install HTCondor-CE</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../job-router-recipes/">Job Router Recipes</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../troubleshoot-htcondor-ce/">Troubleshooting HTCondor-CE</a>
  
        </li>
        <li class=" current">
          
  
    <a class="current" href="./">Submitting to HTCondor-CE</a>
  
  <ul class="subnav">
      
    <li class="toctree-l3"><a href="#submitting-jobs-to-an-htcondor-ce">Submitting Jobs to an HTCondor-CE</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#submitting-jobs">Submitting Jobs...</a></li>
        
            <li><a class="toctree-l4" href="#how-job-routes-affect-your-job">How Job Routes Affect Your Job</a></li>
        
            <li><a class="toctree-l4" href="#troubleshooting-your-jobs">Troubleshooting Your Jobs</a></li>
        
            <li><a class="toctree-l4" href="#reference">Reference</a></li>
        
        </ul>
    

  </ul>
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Worker Node</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../worker-node/using-wn/">Worker Node Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-wn/">Worker Node (RPM install)</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-wn-tarball/">Worker Node (tarball install)</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-wn-oasis/">Worker Node (OASIS install)</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-cvmfs/">CVMFS</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-singularity/">Singularity</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Data</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../data/frontier-squid/">Install HTTP Cache</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/update-oasis/">Update OASIS</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/external-oasis-repos/">External OASIS repositories</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/gridftp/">Install GridFTP Server</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/load-balanced-gridftp/">Install Load Balanced GridFTP</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-gridftp-xrootd/">Install GridFtp XRootD</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/hadoop-overview/">Hadoop Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-hadoop-2-0-0/">Hadoop</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/xrootd-overview/">XRootD Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-xroot-client/">Install XRootD Client</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-xrootd/">Install XRootD</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Security</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../security/lcmaps-voms-authentication/">LCMAPS-VOMS authentication</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../security/host-certs/">Host Certificates</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../security/user-certs/">User Certificates</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../security/osg-ca-manage/">Managing CAs</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Common</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../common/install-best-practices/">Install Best Practices</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../common/ca/">CA Certificates</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../common/osg-ca-certs-updater/">OSG CA Certificates Updater</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../common/yum/">Yum Repos</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../common/openjdk7/">Java 7</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Usage Guides</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../common/pki-cli/">Certificate Tools</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/configuration-with-osg-configure/">Configuration with OSG-Configure</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Other</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../other/gsissh/">GSI-enabled SSH</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-gwms-frontend/">GlideinWMS Frontend</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-cvmfs-stratum1/">Install a CVMFS Stratum 1</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/network-performance-toolkit/">Network Performance Toolkit</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Release Information</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../release/notes/">Release Notes</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/release_series/">OSG Release Series</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/supported_platforms/">Supported Platforms</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-osg-upcoming-software/">OSG upcoming software</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/yum-basics/">Yum Basics</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/signing/">RPM Signing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/contrib/">Contrib Software</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Monitoring</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../monitoring/install-rsv/">Install RSV</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../monitoring/advanced-rsv-configuration/">Advanced RSV Configuration</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../monitoring/rsv-control/">Manage RSV via rsv-control</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../monitoring/install-rsv-gwms-tester/">RSV GlideinWMS Tester</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Deprecated Software</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../data/bestman-install/">BeStMan Install</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-bestman-xrootd/">BeStMan Xrootd SE</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../security/edg-mkgridmap/">EDG-Mkgridmap Install</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../security/install-gums/">GUMS</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-glexec/">Worker node glexec Install</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-voms/">Install VOMS</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  
    <a class="" href="../../common/help/">Get Help</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OSG Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Compute Element &raquo;</li>
        
      
    
    <li>Submitting to HTCondor-CE</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/edit/master/docs/compute-element/submit-htcondor-ce.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="submitting-jobs-to-an-htcondor-ce">Submitting Jobs to an HTCondor-CE<a class="headerlink" href="#submitting-jobs-to-an-htcondor-ce" title="Permanent link">&para;</a></h1>
<p>This document outlines methods of manual submission to an HTCondor-CE. It is intended for site administrators wishing to verify the functionality of their HTCondor-CE installation and developers writing software to submit jobs to an HTCondor-CE (e.g., pilot jobs).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most incoming jobs are pilots from factories and that manual submission does not reflect the standard method that jobs are submitted to OSG CE’s.</p>
</div>
<h2 id="submitting-jobs">Submitting Jobs...<a class="headerlink" href="#submitting-jobs" title="Permanent link">&para;</a></h2>
<p>There are two main methods for submitting files to an HTCondor-CE: using the tools bundled with the <code>htcondor-ce-client</code> package and using the <code>condor_submit</code> command with a submit file. Both methods will test end-to-end job submission but the former method is simpler while the latter will walk you through writing your own submit file.</p>
<p>Before attempting to submit jobs, you will need to generate a proxy from a user certificate before running any jobs. To generate a proxy, run the following command on the host you plan on submitting from:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> voms-proxy-init
</pre></div>


<h3 id="using-htcondor-ce-tools">Using HTCondor-CE tools<a class="headerlink" href="#using-htcondor-ce-tools" title="Permanent link">&para;</a></h3>
<p>There are two HTCondor-CE tools that allow users to test the functionality of their HTCondor-CE: <a href="../troubleshoot-htcondor-ce#condor_ce_trace">condor_ce_trace</a> and <a href="../troubleshoot-htcondor-ce#condor_ce_run">condor_ce_run</a>. The former is the preferred tool as it provides useful feedback if failure occurs while the latter is simply an automated submission tool. These commands may be run from any host that has <code>htcondor-ce-client</code> installed, which you may wish to do if you are testing availability of your CE from an external source.</p>
<h4 id="condor_ce_trace">condor_ce_trace<a class="headerlink" href="#condor_ce_trace" title="Permanent link">&para;</a></h4>
<p><code>condor_ce_trace</code> is a Python script that uses HTCondor's Python bindings to run diagnostics, including job submission, against your HTCondor-CE. To submit a job with <code>condor_ce_trace</code>, run the following command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> condor_ce_trace --debug condorce.example.com
</pre></div>


<p>Replacing <code>condorce.example.com</code> with the hostname of the CE you wish to test. On success, you will see <code>Job status: Completed</code> and the environment of the job on the worker node it landed on. If you do not get the expected output, refer to the <a href="../troubleshoot-htcondor-ce#condor_ce_trace">troubleshooting guide</a>.</p>
<h5 id="requesting-resources">Requesting resources<a class="headerlink" href="#requesting-resources" title="Permanent link">&para;</a></h5>
<p><code>condor_ce_trace</code> doesn't make any specific resource requests so its jobs are only given the default resources by the CE. To request specific resources (or other job attributes), you can specify the <code>--attribute</code> option on the command line:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> condor_ce_trace --debug --attribute<span class="o">=</span><span class="s1">&#39;+resource1=value1&#39;</span>...--attribute<span class="o">=</span><span class="s1">&#39;+resourceN=valueN&#39;</span> condorce.example.com
</pre></div>


<p>To submit a job that requests 4 cores, 4 GB of RAM, a wall clock time of 2 hours, and the 'osg' queue, run the following command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> condor_ce_trace --debug --attribute<span class="o">=</span><span class="s1">&#39;+xcount=4&#39;</span> --attribute<span class="o">=</span><span class="s1">&#39;+maxMemory=4000&#39;</span> --attribute<span class="o">=</span><span class="s1">&#39;+maxWallTime=120&#39;</span> --attribute<span class="o">=</span><span class="s1">&#39;+remote_queue=osg&#39;</span> condorce.example.com
</pre></div>


<p>For a list of other attributes that can be set with the <code>--attribute</code> option, consult the <a href="#job-attributes">job attributes</a> section.</p>
<h4 id="condor_ce_run">condor_ce_run<a class="headerlink" href="#condor_ce_run" title="Permanent link">&para;</a></h4>
<p><code>condor_ce_run</code> is a Python script that calls <code>condor_submit</code> on a generated submit file and tracks its progress with <code>condor_q</code>. To submit a job with <code>condor_ce_run</code>, run the following command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> condor_ce_run -r condorce.example.com:9619 /bin/env
</pre></div>


<p>Replacing <code>condorce.example.com</code> with the hostname of the CE you wish to test. The command will not return any output until it completes: When it does you will see the environment of the job on the worker noded it landed on. If you do not get the expected output, refer to the <a href="../troubleshoot-htcondor-ce#condor_ce_run">troubleshooting guide</a>.</p>
<h3 id="using-a-submit-file">Using a submit file...<a class="headerlink" href="#using-a-submit-file" title="Permanent link">&para;</a></h3>
<p>If you are familiar with HTCondor, submitting a job to an HTCondor-CE using a submit file follows the same procedure as submitting a job to an HTCondor batch system: Write a submit file and use <code>condor_submit</code> (or in one of our cases, <code>condor_ce_submit</code>) to submit the job. This is by virtue of the fact that HTCondor-CE is just a special configuration of HTCondor. The major differences occur in the specific attributes for the submit files outlined below.</p>
<h4 id="from-the-ce-host">From the CE host<a class="headerlink" href="#from-the-ce-host" title="Permanent link">&para;</a></h4>
<p>This method uses <code>condor_ce_submit</code> to submit directly to an HTCondor-CE. The only reason we use <code>condor_ce_submit</code> in this case is to take advantage of the already running daemons on the CE host.</p>
<ol>
<li>
<p>Write a submit file, <code>ce_test.sub</code>:</p>
<div class="codehilite"><pre><span></span># Required for local HTCondor-CE submission
universe = vanilla
use_x509userproxy = true
+Owner = undefined

# Files
executable = <span style="color:red">ce_test.sh</span>
output = ce_test.out
error = ce_test.err
log = ce_test.log

# File transfer behavior
ShouldTransferFiles = YES
WhenToTransferOutput = ON_EXIT

# Optional resource requests
#+xcount = 4            # Request 4 cores
#+maxMemory = 4000      # Request 4GB of RAM
#+maxWallTime = 120     # Request 2 hrs of wall clock time
#+remote_queue = &quot;osg&quot;  # Request the OSG queue

# Run job once
queue
</pre></div>


<p>Replacing <code>ce_test.sh</code> with the path to the executable you wish to run.</p>
<ol>
<li>
<p>You can use any executable you choose for the <code>executable</code> field. If you don't have one in mind, you may use the following example test script:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

date
hostname
env
</pre></div>
</td></tr></table>

</li>
<li>
<p>Mark the test script as executable:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> chmod +x ce_test.sh
</pre></div>


</li>
</ol>
</li>
<li>
<p>Submit the job:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> condor_ce_submit ce_test.sub
</pre></div>


</li>
</ol>
<h4 id="from-another-host">From another host<a class="headerlink" href="#from-another-host" title="Permanent link">&para;</a></h4>
<p>For this method, you will need a functional HTCondor submit node. If you do not have one readily available, you can install the <code>condor</code> package from the OSG repository to get a simple submit node:</p>
<ol>
<li>
<p>Install HTCondor:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> yum install condor
</pre></div>


</li>
<li>
<p>Start the <code>condor</code> service:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host $</span> service condor start
</pre></div>


</li>
</ol>
<p>Once the <code>condor</code> service is running, write a submit file and submit your job:</p>
<ol>
<li>
<p>Write a submit file, <code>ce_test.sub</code>:</p>
<div class="codehilite"><pre><span></span># Required for remote HTCondor-CE submission
universe = grid
use_x509userproxy = true
grid_resource = condor <span style="color:red">condorce.example.com condorce.example.com</span>:9619

# Files
executable = <span style="color:red">ce_test.sh</span>
output = ce_test.out
error = ce_test.err
log = ce_test.log

# File transfer behavior
ShouldTransferFiles = YES
WhenToTransferOutput = ON_EXIT

# Optional resource requests
#+xcount = 4            # Request 4 cores
#+maxMemory = 4000      # Request 4GB of RAM
#+maxWallTime = 120     # Request 2 hrs of wall clock time
#+remote_queue = &quot;osg&quot;  # Request the OSG queue

# Run job once
queue
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>grid_resource</code> line should start with <code>condor</code> and is not related to which batch system you are using.</p>
</div>
<ol>
<li>
<p>You can use any executable you choose for the <code>executable</code> field. If you don't have one in mind, you may use the following example test script:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

date
hostname
env
</pre></div>
</td></tr></table>

</li>
<li>
<p>Mark the test script as executable:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> chmod +x ce_test.sh
</pre></div>


</li>
</ol>
</li>
<li>
<p>Submit the job:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> condor_submit ce_test.sub
</pre></div>


</li>
</ol>
<h4 id="tracking-job-progress">Tracking job progress<a class="headerlink" href="#tracking-job-progress" title="Permanent link">&para;</a></h4>
<p>When the job completes, stdout will be placed into <code>ce_test.out</code>, stderr will be placed into <code>ce_test.err</code>, and HTCondor logging information will be placed in <code>ce_test.log</code>. You can track job progress by looking at the condor queue by running the following command on the CE host:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> condor_ce_q
</pre></div>


<p>Using the following table to determine job status:</p>
<table>
<thead>
<tr>
<th align="left">This value in the <code>ST</code> column...</th>
<th align="left">Means that the job is...</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">I</td>
<td align="left">idle</td>
</tr>
<tr>
<td align="left">C</td>
<td align="left">complete</td>
</tr>
<tr>
<td align="left">X</td>
<td align="left">being removed</td>
</tr>
<tr>
<td align="left">H</td>
<td align="left">held</td>
</tr>
<tr>
<td align="left">&lt;</td>
<td align="left">transferring input</td>
</tr>
<tr>
<td align="left">&gt;</td>
<td align="left">transferring output</td>
</tr>
</tbody>
</table>
<h2 id="how-job-routes-affect-your-job">How Job Routes Affect Your Job<a class="headerlink" href="#how-job-routes-affect-your-job" title="Permanent link">&para;</a></h2>
<p>Upon successful submission of your job, the Job Router takes control of your job by matching it to routes and submitting a transformed job to your batch system.</p>
<h3 id="matching">Matching<a class="headerlink" href="#matching" title="Permanent link">&para;</a></h3>
<p>First, the Job Router checks if your job <a href="../job-router-recipes#filtering-jobs-based-on">matches any routes</a>. It does this by checking the routes <code>Requirements</code> expression against the job and selecting the first match. If your job does not match any routes, the job will be put on hold and eventually removed from the CE queue without completing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For versions of HTCondor &lt; 8.7.1, the JobRouter matches jobs to routes in a round-robin fashion. This means that if a job can match to multiple routes, it can be routed by any of them! So when writing job routes, make sure that they are exclusive to each other and that your jobs can only match to a single route.</p>
</div>
<p><strong>Examples</strong></p>
<p>The following three routes only perform filtering and submission of routed jobs to an HTCondor batch system. The only differences are in the types of jobs that they match:</p>
<ul>
<li><strong>Route 1:</strong> Matches jobs whose attribute <code>foo</code> is equal to <code>bar</code>.</li>
<li><strong>Route 2:</strong> Matches jobs whose attribute <code>foo</code> is equal to <code>baz</code>.</li>
<li><strong>Route 3:</strong> Matches jobs whose attribute <code>foo</code> is neither equal to <code>bar</code> nor <code>baz</code>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting a custom attribute for job submission requires the <code>+</code> prefix in your submit file but it is unnecessary in the job routes.</p>
</div>
<div class="codehilite"><pre><span></span>JOB_ROUTER_ENTRIES = [ \
     TargetUniverse = 5; \
     name = &quot;Route 1&quot;; \
     Requirements = (TARGET.foo =?= &quot;bar&quot;); \
] \
[ \
     TargetUniverse = 5; \
     name = &quot;Route 2&quot;; \
     Requirements = (TARGET.foo =?= &quot;baz&quot;); \
] \
[ \
     TargetUniverse = 5; \
     name = &quot;Route 3&quot;; \
     Requirements = (TARGET.foo =!= &quot;bar&quot;) &amp;&amp; (TARGET.foo =!= &quot;baz&quot;); \
]
</pre></div>


<p>If a user could submitted their job with <code>+foo=bar</code>, the job would match <code>Route 1</code>.</p>
<h3 id="route-defaults">Route defaults<a class="headerlink" href="#route-defaults" title="Permanent link">&para;</a></h3>
<p><a href="../job-router-recipes#setting-a-default">Route defaults</a> can be set for batch system queue, maximum memory, number of cores to request, and maximum walltime. The submitting user can override any of these by setting the corresponding <a href="#job-attributes">attribute</a> in their job.</p>
<p><strong>Examples</strong></p>
<p>The following route takes all incoming jobs and submits them to an HTCondor batch system requesting 1GB of memory.</p>
<div class="codehilite"><pre><span></span>JOB_ROUTER_ENTRIES = [ \
     TargetUniverse = 5; \
     name = &quot;Route 1&quot;; \
     set_default_maxMemory = 1000; \
]
</pre></div>


<p>A user could submit their job with the attribute <code>+maxMemory=2000</code> and that job would be submitted requesting 2GB memory instead of the default of 1GB.</p>
<h2 id="troubleshooting-your-jobs">Troubleshooting Your Jobs<a class="headerlink" href="#troubleshooting-your-jobs" title="Permanent link">&para;</a></h2>
<h4 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h4>
<p>All interactions between <code>condor_submit</code> and the CE will be recorded in the file specified by the <code>log</code> attribute in your submit file. This includes acknowledgement of the job in your local queue, connection to the CE, and a record of job completion:</p>
<div class="codehilite"><pre><span></span>000 (786.000.000) 12/09 16:49:55 Job submitted from host: &lt;131.225.154.68:53134&gt;
...
027 (786.000.000) 12/09 16:50:09 Job submitted to grid resource
    GridResource: condor condorce.example.com condorce.example.com:9619
    GridJobId: condor condorce.example.com condorce.example.com:9619 796.0
...
005 (786.000.000) 12/09 16:52:19 Job terminated.
        (1) Normal termination (return value 0)
                Usr 0 00:00:00, Sys 0 00:00:00  -  Run Remote Usage
                Usr 0 00:00:00, Sys 0 00:00:00  -  Run Local Usage
                Usr 0 00:00:00, Sys 0 00:00:00  -  Total Remote Usage
                Usr 0 00:00:00, Sys 0 00:00:00  -  Total Local Usage
        0  -  Run Bytes Sent By Job
        0  -  Run Bytes Received By Job
        0  -  Total Bytes Sent By Job
        0  -  Total Bytes Received By Job
</pre></div>


<p>If there are issues contacting the CE, you will see error messages about a 'Down Globus Resource':</p>
<div class="codehilite"><pre><span></span>020 (788.000.000) 12/09 16:56:17 Detected Down Globus Resource
    RM-Contact: fermicloud133.fnal.gov
...
026 (788.000.000) 12/09 16:56:17 Detected Down Grid Resource
    GridResource: condor condorce.example.com condorce.example.com:9619
</pre></div>


<p>This indicates a communication issue with your CE that can be diagnosed with <a href="../troubleshoot-htcondor-ce#condor_ce_ping">condor_ce_ping</a>.</p>
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<p>Here are some other HTCondor-CE documents that might be helpful:</p>
<ul>
<li><a href="../htcondor-ce-overview">HTCondor-CE overview and architecture</a></li>
<li><a href="../install-htcondor-ce">Installing HTCondor-CE</a></li>
<li><a href="../job-router-recipes">Configuring HTCondor-CE job routes</a></li>
<li><a href="../troubleshoot-htcondor-ce">The HTCondor-CE troubleshooting guide</a></li>
</ul>
<h3 id="job-attributes">Job attributes<a class="headerlink" href="#job-attributes" title="Permanent link">&para;</a></h3>
<p>The following table is a reference of job attributes that can be included in HTCondor submit files and their GlobusRSL equivalents. A more comprehensive list of submit file attributes specific to HTCondor-CE can be found in the <a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#SECTION0012574000000000000000">HTCondor manual</a>.</p>
<table>
<thead>
<tr>
<th><strong>HTCondor Attribute</strong></th>
<th><strong>Globus RSL</strong></th>
<th><strong>Summary</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#93578">arguments</a></td>
<td>arguments</td>
<td>Arguments that will be provided to the executable for the job.</td>
</tr>
<tr>
<td><a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#93627">error</a></td>
<td>stderr</td>
<td>Path to the file on the client machine that stores stderr from the job.</td>
</tr>
<tr>
<td><a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#93633">executable</a></td>
<td>executable</td>
<td>Path to the file on the client machine that the job will execute.</td>
</tr>
<tr>
<td><a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#93652">input</a></td>
<td>stdin</td>
<td>Path to the file on the client machine that stores input to be piped into the stdin of the job.</td>
</tr>
<tr>
<td>+maxMemory</td>
<td>maxMemory</td>
<td>The amount of memory in MB that you wish to allocate to the job.</td>
</tr>
<tr>
<td>+maxWallTime</td>
<td>maxWallTime</td>
<td>The maximum walltime (in minutes) the job is allowed to run before it is removed.</td>
</tr>
<tr>
<td><a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#93690">output</a></td>
<td>stdout</td>
<td>Path to the file on the client machine that stores stdout from the job.</td>
</tr>
<tr>
<td>+remote_queue</td>
<td>queue</td>
<td>Assign job to the target queue in the scheduler. Note that the queue name should be in quotes.</td>
</tr>
<tr>
<td><a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#93968">transfer_input_files</a></td>
<td>file_stage_in</td>
<td>A comma-delimited list of all the files and directories to be transferred into the working directory for the job, before the job is started.</td>
</tr>
<tr>
<td><a href="http://research.cs.wisc.edu/htcondor/manual/v8.6/condor_submit.html#93976">transfer_output_files</a></td>
<td>transfer_output_files</td>
<td>A comma-delimited list of all the files and directories to be transferred back to the client, after the job completes.</td>
</tr>
<tr>
<td>+xcount</td>
<td>xcount</td>
<td>The number of cores to allocate for the job.</td>
</tr>
</tbody>
</table>
<p>If you are setting an attribute to a string value, make sure enclose the string in double-quotes (<code>"</code>), otherwise HTCondor-CE will try to find an attribute by that name.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../worker-node/using-wn/" class="btn btn-neutral float-right" title="Worker Node Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../troubleshoot-htcondor-ce/" class="btn btn-neutral" title="Troubleshooting HTCondor-CE"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opensciencegrid/docs" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../troubleshoot-htcondor-ce/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../worker-node/using-wn/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
